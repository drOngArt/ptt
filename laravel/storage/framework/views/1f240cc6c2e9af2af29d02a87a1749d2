<?php $__env->startSection('title'); ?>
    Aktualna runda
<?php $__env->stopSection(); ?>

<?php $__env->startSection('content'); ?>
    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <?php if($round != null): ?>
                    <h1 class="page-header">
                        <?php if($prevRoundIdFromDB > 0): ?>
                            <small><a href="<?php echo e($baseURI); ?>/admin/roundFromDb/<?php echo e($prevRoundIdFromDB); ?>" class="btn btn-secondary btn-sm fa fa-step-backward" role="button"></a></small>
                        <?php endif; ?>
                        <?php echo e($roundDescription); ?>, <?php echo e($danceName); ?>

                        <?php if($nextRoundIdFromDB > 0): ?>
                            <div class="pull-right">
                            <small><a href="<?php echo e($baseURI); ?>/admin/roundFromDb/<?php echo e($nextRoundIdFromDB); ?>" class="btn btn-secondary btn-sm fa fa-step-forward" role="button"></a></small>
                            </div>
                        <?php endif; ?>
                    </h1>
                    <h4>
                        <?php if( $roundDescription[0] != 'F'): ?>
                           <button class="btn btn-primary" type="button" data-toggle="modal" data-target=".showGroupsModal">Grupy
                           <span class="badge badge-pill">
                              <?php if( $groups == false ): ?>
                                 ---
                              <?php else: ?>
                                 <?php echo e($groups); ?>

                              <?php endif; ?>
                           </span></button>
                        <?php endif; ?>
                        <button class="btn btn-primary" type="button" data-toggle="modal" data-target=".showCouplesModal">
                           <i class="fa fa-female fa-lg" aria-hidden="true"></i><i class="fa fa-male fa-lg" aria-hidden="true"></i>
                           <span class="badge badge-pill-danger">
                           <?php if( $couples == false ): ?>
                              ---
                           <?php else: ?>
                              <?php echo e($couples); ?> 
                           <?php endif; ?>
                        </span></button>
                        <?php if( $roundDescription[0] != 'F'): ?>
                           <i class="fa fa-lg fa-sign-out fa-fw" aria-hidden="true"></i> 
                           <button class="btn btn-deep-orange" type="button">Awans
                           <span class="badge green badge-pill"><?php echo e($votes); ?></span></button>
                        <?php endif; ?>
                    </h4>
                    <div class="alternativeDescription"> <?php echo e($roundAlternativeDescription); ?> </div>
                <?php else: ?>
                    <h1 class="page-header">
                        <?php if($prevRoundIdFromDB > 0): ?>
                            <small><a href="<?php echo e($baseURI); ?>/admin/roundFromDb/<?php echo e($prevRoundIdFromDB); ?>" class="btn btn-secondary btn-sm fa fa-step-backward" role="button"></a></small>
                        <?php endif; ?>
                        <?php echo e($roundDescription); ?> - <?php echo e($danceName); ?>

                    </h1>
                    <div class="alternativeDescription"> <?php echo e($roundAlternativeDescription); ?> </div>
                <?php endif; ?>
            </div>
            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->

    <!--<div class="modal" id="myModal" tabindex="-1" role="dialog">
         <div class="modal-dialog"  role="document">
          <div class="modal-content">
           <div class="modal-header">
            <h5 class="modal-title">Modal title</h5>
             <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
             </button>
           </div>
          <div class="modal-body">
           <p><?php echo e(Session::get('success', '')); ?></p>
          </div>
         <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Zamknij</button>
         </div>
        </div>
       </div>
      </div> -->

   <?php if(Session::has('success')): ?>
    <div class="alert alert-success alert-dismissible">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <strong>BRAWO !!</strong> <?php echo e(Session::get('success', '')); ?>

    </div>
    <?php endif; ?>
    
    <?php if(Session::has('alert')): ?>
    <div class="alert alert-danger .alert-dismissible">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
    <h3><strong>BŁĄD !!!</strong> <?php echo e(Session::get('alert', '')); ?></h3>
    </div>

<?php endif; ?>

        <div class="table-responsive">
            <table class="table table-striped">
                <tbody>
                    <?php foreach($judges as $judge): ?>
                    <tr>
                        <td>
                            <div id="status<?php echo e($judge->sign); ?>">
                                <button class="btn-circle"><?php echo e($judge->sign); ?></button>
                                <?php if( $judge->without_pass == true ): ?>
                                    <a href="<?php echo e($baseURI); ?>/admin/password/<?php echo e($judge->id); ?>/false" class="btn btn-orange" role="button"> USTAW HASŁO </a>
                                <?php endif; ?>
                                <span class="font-14pt"> <?php echo e($judge->lastName); ?> <?php echo e($judge->firstName); ?></span>
                            </div>
                        </td>
                        <td>
                            <button id="completed<?php echo e($judge->sign); ?>" type="button" class="btn btn-outline hidden fa fa-check-square-o fa-lg judgeResultsButton" 
                                data-toggle="modal" data-target=".judgeResults" data-judge-sign="<?php echo e($judge->sign); ?>" data-judge-name="<?php echo e($judge->firstName); ?> <?php echo e($judge->lastName); ?>">
                            </button>
                            <div id="completedText<?php echo e($judge->sign); ?>" class="hidden"></div>
                        </td>
                    </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>

        <?php if($roundIdFromDB == 0): ?>
            <div class="row">
                <div class="col-lg-12">
                    <div class="pull-right">
                        <?php if(count($roundsToUndo) > 0): ?>
                            <button type="button" class="btn btn-danger button-menu" data-toggle="modal" data-target=".roundUndoModal">Powtórz taniec</button>
                        <?php else: ?>
                            <button disabled type="button" class="btn btn-danger" data-toggle="modal" data-target=".roundUndoModal">Powtórz taniec</button>
                        <?php endif; ?>
                        <a class="confirmation" href="<?php echo e($baseURI); ?>/admin/round/forceCloseDance/<?php echo e($localRoundId); ?>"><button type="button" class="btn btn-warning button-menu">Zakończ taniec</button></a>
                        <?php if(count($roundsToClose) > 0): ?>
                            <button type="button" class="btn btn-success button-menu" data-toggle="modal" data-target=".roundCloseModal">Zapisz rundę</button>
                        <?php else: ?>
                            <button disabled type="button" class="btn btn-success" data-toggle="modal" data-target=".roundCloseModal">Zapisz rundę</button>
                        <?php endif; ?>
                    </div>
                </div>
            </div>
        <?php endif; ?>
    </div>
    <!-- /#page-wrapper -->

    <div class="modal fade roundCloseModal" tabindex="-1" role="dialog" aria-labelledby="roundClose" aria-hidden="true">
        <?php echo Form::open(array('url' => 'admin/round', 'method' => 'POST')); ?>

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Zapisz rundę</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <select name="roundToClose" class="form-control">
                            <?php foreach($roundsToClose->reverse() as $roundToClose): ?>
                                <option value="<?php echo e($roundToClose->id); ?>"><?php echo e($roundToClose->description); ?></option>
                            <?php endforeach; ?>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                   <div class="pull-left">
                     <button type="button" class="btn btn-lg btn-warning button-menu" data-dismiss="modal">Anuluj</button>
                   </div>
                   <div class="pull-right"> 
                     <?php echo Form::submit('Zapisz', array('class' => 'btn btn-primary button-menu')); ?>

                   </div> 
                </div>
            </div>
        </div>
        <?php echo Form::close(); ?>

    </div>


    <div class="modal fade roundUndoModal" tabindex="-1" role="dialog" aria-labelledby="roundUndo" aria-hidden="true">
        <?php echo Form::open(array('url' => 'admin/round/undoRound', 'method' => 'POST')); ?>

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Powtórz taniec</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <select name="roundToUndo" class="form-control">
                            <option selected disabled hidden>Wybierz kategorię i taniec do powtórzenia:</option>
                            <?php foreach($roundsToUndo->reverse() as $roundToUndo): ?>
                                <option value="<?php echo e($roundToUndo->id); ?>"><?php echo e($roundToUndo->description); ?>, <?php echo e($roundToUndo->dance); ?></option>
                            <?php endforeach; ?>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                  <div class="pull-left">
                    <button type="button" class="btn btn-lg btn-warning button-menu" data-dismiss="modal">Anuluj</button>
                  </div>
                  <div class="pull-right"> 
                    <?php echo Form::submit('Powtórz taniec', array('class' => 'btn btn-primary button-menu')); ?>

                  </div>
                </div>
            </div>
        </div>
        <?php echo Form::close(); ?>

    </div>

    <div class="modal fade judgeResults" tabindex="-1" role="dialog" aria-labelledby="judgeResults" aria-hidden="true">
        <?php echo Form::open(array('url' => 'admin/round/undoRound', 'method' => 'POST', 'id'=>'judgeUndoForm')); ?>

        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Typowania sędziego</h4>
                </div>
                <div class="modal-body">
                        <div><label id="judgeResultsSign" value=""></label></div>
                        <div><label id="judgeResultsRound" value = "<?php echo e($localRoundId); ?>"><?php echo e($roundDescription); ?>, <?php echo e($danceName); ?></label></div>
                        <div id="judgeResultsVotes" value = ""></div>
                        
                        <input hidden name="roundToUndo" value = "<?php echo e($localRoundId); ?>"></input>
                        <input hidden id="judgeToUndo" name="judgeToUndo" value =""></input>
                </div>
                <div class="modal-footer">
                  <div class="pull-left">
                    <button type="button" class="btn btn-lg btn-warning button-menu" data-dismiss="modal">Anuluj</button>
                  </div>
                  <div class="pull-right">  
                    <?php echo Form::submit('Powtórz taniec', array('class' => 'btn btn-danger button-menu', 'id'=>'judgeUndoButton')); ?>

                  </div>
                </div>
            </div>
        </div>
        <?php echo Form::close(); ?>

    </div>

  	<!-- show couples -->
   <div class="modal fade showCouplesModal" tabindex="-1" role="dialog" aria-labelledby="showCouples" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
               <h4 class="modal-title" align="center"><b>Lista par w <?php echo e($roundDescription); ?></b></h4>
            </div>
            <div class="modal-body">
               <div class="row">
                  <div class="col-lg-12">
                     <table class="table table-bordered">
                        <tbody class="btn-lblue-gray">
                        <?php if( $names ): ?>
                           <tr>
                              <th >Numer</th>
                              <th >Nazwisko i imię</th>
                              <th >Klub /Kraj</th>
                           </tr>
                           <?php foreach($names as $couple): ?>
                              
                           <tr>
                              <td class="text-center"><?php echo e($couple->number); ?></td>
                              <td>
                                 <?php echo e($couple->firstNameA); ?> <?php echo e($couple->lastNameA); ?></br>
                                 <?php echo e($couple->firstNameB); ?> <?php echo e($couple->lastNameB); ?> 
                              </td>
                              <td>
                                 <?php echo e($couple->club); ?> </br>
                                 <?php echo e($couple->country); ?>

                              </td>
                           </tr> 
                           <?php endforeach; ?>
                        <?php endif; ?>
                     </tbody>
                     </table>
                  </div>
               </div>
            </div>
         </div>
      </div>
    </div>

   <!-- show groups-->
   <div class="modal fade showGroupsModal" tabindex="-1" role="dialog" aria-labelledby="showGroups" aria-hidden="true">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
               <h3 class="modal-title" align="left"><?php echo e($danceName); ?> - grupy <?php echo e($roundDescription); ?></h3>
            </div>
            <div class="modal-body">
               <div class="row">
                  <div class="col-lg-12">
                     <table class="table table-bordered">
                        <tbody class="btn-lblue-gray" >
                        <?php if( $dance ): ?>
                           <?php $idx = 1; ?>
                           <?php foreach($dance->couples as $groups): ?>
                            <tr class='font-14pt'>
                              <td >
                              <?php if( count($dance->couples) > 1 ): ?>
                                 Grupa <?php echo e($idx); ?>:&nbsp 
                              <?php else: ?>
                                 Numery:
                              <?php endif; ?>
                              </td>
                              <td>
                                <?php foreach($groups as $couple): ?>
                                    <?php echo e($couple->number); ?>&nbsp
                                <?php endforeach; ?>
                              </td>
                              <?php $idx++; ?>
                           </tr> 
                           <?php endforeach; ?>
                        <?php endif; ?>
                     </tbody>
                     </table>
                  </div>
               </div>
            </div>
         </div>
      </div>
    </div>
    
<?php $__env->stopSection(); ?>

<?php $__env->startSection('customScripts'); ?>
    <?php echo HTML::script('js/adminRound.js'); ?>

    <script>
        var adminRefreshTimer = "<?php echo e(Config::get('ptt.adminRefreshTimer')); ?>";
        var roundIdFromDB = <?php echo e($roundIdFromDB); ?>;
        var baseURI = "<?php echo e($baseURI); ?>";
        <?php if($danceName != null || $roundDescription!=null): ?>
            var roundName = "<?php echo e($roundDescription); ?>" + ", " + "<?php echo e($danceName); ?>";
        <?php endif; ?>
        /*var msg = '<?php echo e(Session::get('alert')); ?>';
        var exist = '<?php echo e(Session::has('alert')); ?>';
        if(exist){
            $('#myModal').modal("show");
        }*/
    </script>
<?php $__env->stopSection(); ?>

<?php echo $__env->make('admin.master', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>